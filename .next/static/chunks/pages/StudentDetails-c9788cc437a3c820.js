(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7766],{66023:function(e,t,s){(window.__NEXT_P=window.__NEXT_P||[]).push(["/StudentDetails",function(){return s(7658)}])},14866:function(e,t,s){"use strict";s.d(t,{C:function(){return d}});var a=s(85893),r=s(67294),l=s(12003),n=s(27742);let i=(0,l.j)("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground",success:"border-transparent bg-islamic-500 text-white hover:bg-islamic-600",warning:"border-transparent bg-accent-500 text-white hover:bg-accent-600",info:"border-transparent bg-blue-500 text-white hover:bg-blue-600",neutral:"border-transparent bg-gray-400 text-white hover:bg-accent-500"},size:{default:"text-xs px-2.5 py-0.5",sm:"text-[10px] px-2 py-0.5",lg:"text-sm px-3 py-1"}},defaultVariants:{variant:"default",size:"default"}}),d=r.forwardRef((e,t)=>{let{className:s,variant:r,size:l,...d}=e;return(0,a.jsx)("div",{ref:t,className:(0,n.cn)(i({variant:r,size:l}),s),...d})});d.displayName="Badge"},32581:function(e,t,s){"use strict";var a=s(85893),r=s(67294),l=s(95364),n=s(22972),i=s(6391),d=s(27742);t.Z=e=>{let{onFileSelect:t,currentImage:s,className:o}=e,c=(0,r.useRef)(null),[u,h]=(0,r.useState)(s||null);return(0,a.jsxs)("div",{className:(0,d.cn)("space-y-2",o),children:[(0,a.jsx)("input",{ref:c,type:"file",accept:"image/*",onChange:e=>{var s;let a=null===(s=e.target.files)||void 0===s?void 0:s[0];if(a){let e=new FileReader;e.onload=e=>{var t;h(null===(t=e.target)||void 0===t?void 0:t.result)},e.readAsDataURL(a),t(a)}},className:"hidden"}),u?(0,a.jsxs)("div",{className:"relative inline-block",children:[(0,a.jsx)("img",{src:u,alt:"Preview",className:"w-20 h-20 rounded-full object-cover border-2 border-gray-200"}),(0,a.jsx)(l.z,{type:"button",variant:"destructive",size:"sm",className:"absolute -top-2 -right-2 h-6 w-6 p-0 rounded-full",onClick:()=>{h(null),t(null),c.current&&(c.current.value="")},children:(0,a.jsx)(n.Z,{className:"h-3 w-3"})})]}):(0,a.jsx)(l.z,{type:"button",variant:"outline",onClick:()=>{var e;return null===(e=c.current)||void 0===e?void 0:e.click()},className:"w-20 h-20 rounded-full border-dashed",children:(0,a.jsx)(i.Z,{className:"h-4 w-4"})})]})}},20362:function(e,t,s){"use strict";s.d(t,{O:function(){return i}});var a=s(85893),r=s(67294),l=s(95364),n=s(27742);let i=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)(l.z,{className:(0,n.cn)("bg-gradient-to-r from-emerald-500 to-teal-400 hover:opacity-90 text-white",s),ref:t,...r})});i.displayName="GradientButton"},15659:function(e,t,s){"use strict";s.d(t,{Bw:function(){return p},Ph:function(){return c},Ql:function(){return f},i4:function(){return h},ki:function(){return u}});var a=s(85893),r=s(67294),l=s(73952),n=s(89934),i=s(87493),d=s(80906),o=s(27742);let c=l.fC;l.ZA;let u=l.B4,h=r.forwardRef((e,t)=>{let{className:s,children:r,...i}=e;return(0,a.jsxs)(l.xz,{ref:t,className:(0,o.cn)("flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",s),...i,children:[r,(0,a.jsx)(l.JO,{asChild:!0,children:(0,a.jsx)(n.Z,{className:"h-4 w-4 opacity-50"})})]})});h.displayName=l.xz.displayName;let x=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)(l.u_,{ref:t,className:(0,o.cn)("flex cursor-default items-center justify-center py-1",s),...r,children:(0,a.jsx)(i.Z,{className:"h-4 w-4"})})});x.displayName=l.u_.displayName;let m=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)(l.$G,{ref:t,className:(0,o.cn)("flex cursor-default items-center justify-center py-1",s),...r,children:(0,a.jsx)(n.Z,{className:"h-4 w-4"})})});m.displayName=l.$G.displayName;let p=r.forwardRef((e,t)=>{let{className:s,children:r,position:n="popper",...i}=e;return(0,a.jsx)(l.h_,{children:(0,a.jsxs)(l.VY,{ref:t,className:(0,o.cn)("relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2","popper"===n&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",s),position:n,...i,children:[(0,a.jsx)(x,{}),(0,a.jsx)(l.l_,{className:(0,o.cn)("p-1","popper"===n&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:r}),(0,a.jsx)(m,{})]})})});p.displayName=l.VY.displayName,r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)(l.__,{ref:t,className:(0,o.cn)("py-1.5 pl-8 pr-2 text-sm font-semibold",s),...r})}).displayName=l.__.displayName;let f=r.forwardRef((e,t)=>{let{className:s,children:r,...n}=e;return(0,a.jsxs)(l.ck,{ref:t,className:(0,o.cn)("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",s),...n,children:[(0,a.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,a.jsx)(l.wU,{children:(0,a.jsx)(d.Z,{className:"h-4 w-4"})})}),(0,a.jsx)(l.eT,{children:r})]})});f.displayName=l.ck.displayName,r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)(l.Z0,{ref:t,className:(0,o.cn)("-mx-1 my-1 h-px bg-muted",s),...r})}).displayName=l.Z0.displayName},70207:function(e,t,s){"use strict";s.d(t,{RM:function(){return d},SC:function(){return o},iA:function(){return n},pj:function(){return u},ss:function(){return c},xD:function(){return i}});var a=s(85893),r=s(67294),l=s(27742);let n=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)("div",{className:"relative w-full overflow-auto",children:(0,a.jsx)("table",{ref:t,className:(0,l.cn)("w-full caption-bottom text-sm",s),...r})})});n.displayName="Table";let i=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)("thead",{ref:t,className:(0,l.cn)("[&_tr]:border-b",s),...r})});i.displayName="TableHeader";let d=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)("tbody",{ref:t,className:(0,l.cn)("[&_tr:last-child]:border-0",s),...r})});d.displayName="TableBody",r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)("tfoot",{ref:t,className:(0,l.cn)("border-t bg-muted/50 font-medium [&>tr]:last:border-b-0",s),...r})}).displayName="TableFooter";let o=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)("tr",{ref:t,className:(0,l.cn)("border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted",s),...r})});o.displayName="TableRow";let c=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)("th",{ref:t,className:(0,l.cn)("h-12 px-4 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0",s),...r})});c.displayName="TableHead";let u=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)("td",{ref:t,className:(0,l.cn)("p-4 align-middle [&:has([role=checkbox])]:pr-0",s),...r})});u.displayName="TableCell",r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)("caption",{ref:t,className:(0,l.cn)("mt-4 text-sm text-muted-foreground",s),...r})}).displayName="TableCaption"},9451:function(e,t,s){"use strict";s.d(t,{g:function(){return n}});var a=s(85893),r=s(67294),l=s(27742);let n=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)("textarea",{className:(0,l.cn)("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm shadow-sm placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",s),ref:t,...r})});n.displayName="Textarea"},12987:function(e,t,s){"use strict";s.d(t,{pm:function(){return h}});var a=s(67294);let r=0,l=new Map,n=e=>{if(l.has(e))return;let t=setTimeout(()=>{l.delete(e),c({type:"REMOVE_TOAST",toastId:e})},1e6);l.set(e,t)},i=(e,t)=>{switch(t.type){case"ADD_TOAST":return{...e,toasts:[t.toast,...e.toasts].slice(0,1)};case"UPDATE_TOAST":return{...e,toasts:e.toasts.map(e=>e.id===t.toast.id?{...e,...t.toast}:e)};case"DISMISS_TOAST":{let{toastId:s}=t;return s?n(s):e.toasts.forEach(e=>{n(e.id)}),{...e,toasts:e.toasts.map(e=>e.id===s||void 0===s?{...e,open:!1}:e)}}case"REMOVE_TOAST":if(void 0===t.toastId)return{...e,toasts:[]};return{...e,toasts:e.toasts.filter(e=>e.id!==t.toastId)}}},d=[],o={toasts:[]};function c(e){o=i(o,e),d.forEach(e=>{e(o)})}function u(e){let{...t}=e,s=(r=(r+1)%Number.MAX_SAFE_INTEGER).toString(),a=()=>c({type:"DISMISS_TOAST",toastId:s});return c({type:"ADD_TOAST",toast:{...t,id:s,open:!0,onOpenChange:e=>{e||a()}}}),{id:s,dismiss:a,update:e=>c({type:"UPDATE_TOAST",toast:{...e,id:s}})}}function h(){let[e,t]=a.useState(o);return a.useEffect(()=>(d.push(t),()=>{let e=d.indexOf(t);e>-1&&d.splice(e,1)}),[e]),{...e,toast:u,dismiss:e=>c({type:"DISMISS_TOAST",toastId:e})}}},7658:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return eo}});var a=s(85893),r=s(67294),l=s(39332),n=s(95364),i=s(21427),d=()=>{let e=(0,l.useRouter)();return(0,a.jsx)("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-4 sm:gap-0 mb-6",children:(0,a.jsxs)("div",{className:"flex flex-row items-center gap-4 w-full sm:w-auto",children:[(0,a.jsx)("button",{type:"button",onClick:()=>e.back(),className:"p-0 m-0 bg-transparent border-none outline-none flex items-center","aria-label":"Back",children:(0,a.jsx)(i.Z,{className:"h-6 w-6"})}),(0,a.jsx)("h1",{className:"text-2xl sm:text-3xl font-bold text-gray-900",children:"Student Details"})]})})},o=s(50947),c=s(37483),u=s(27742);let h=r.forwardRef((e,t)=>{let{className:s,value:r,indicatorClassName:l,...n}=e;return(0,a.jsx)(c.fC,{ref:t,className:(0,u.cn)("relative h-4 w-full overflow-hidden rounded-full bg-secondary",s),...n,children:(0,a.jsx)(c.z$,{className:(0,u.cn)("h-full w-full flex-1 bg-primary transition-all",l),style:{transform:"translateX(-".concat(100-(r||0),"%)")}})})});h.displayName=c.fC.displayName;var x=s(42964),m=s(88886),p=s(9464),f=s(97613),g=s(17911),j=s(99737),v=s(37663),y=s(37435),b=s(20362),N=s(87095),w=s(7825),_=s(9451),S=s(15659),C=s(36460),D=s(70550),E=s(12987),P=s(88055),T=s(81462),k=e=>{let{studentId:t,onProgressAdded:s}=e,[l,i]=(0,r.useState)(!1),[d,o]=(0,r.useState)(!1),{profile:c}=(0,P.a)(),[u,h]=(0,r.useState)({type:"",date:new Date().toISOString().split("T")[0],surah_or_jilid:"",ayat_or_page:"",notes:""}),{toast:x}=(0,E.pm)();if((null==c?void 0:c.role)!=="teacher")return null;let m=async e=>{e.preventDefault(),o(!0);try{if((null==c?void 0:c.role)!=="teacher"){x({title:"Unauthorized",description:"Only teachers can add progress entries.",variant:"destructive"});return}let{error:e}=await D.O.from("progress_entries").insert([{student_id:t,...u}]);if(e)throw e;x({title:"Success",description:"Progress entry added successfully!"}),h({type:"",date:new Date().toISOString().split("T")[0],surah_or_jilid:"",ayat_or_page:"",notes:""}),i(!1),s()}catch(e){console.error("Error adding progress:",e),x({title:"Error",description:"Failed to add progress entry. Please try again.",variant:"destructive"})}finally{o(!1)}},p=(e,t)=>{h(s=>({...s,[e]:t}))};return(0,a.jsxs)(y.Vq,{open:l,onOpenChange:i,children:[(0,a.jsx)(y.hg,{asChild:!0,children:(0,a.jsxs)(n.z,{className:"bg-gradient-to-r from-emerald-500 to-teal-400 hover:opacity-90",children:[(0,a.jsx)(C.Z,{className:"h-4 w-4 mr-2"}),"Add Progress"]})}),(0,a.jsxs)(y.cZ,{className:"sm:max-w-[425px]","aria-describedby":"add-progress-description",children:[(0,a.jsxs)(y.fK,{children:[(0,a.jsx)(y.$N,{children:"Add Daily Progress"}),(0,a.jsx)(y.Be,{id:"add-progress-description",children:"Fill in the details to add a new daily progress entry for the student."})]}),(0,a.jsxs)("form",{onSubmit:m,className:"space-y-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(w._,{htmlFor:"type",children:"Progress Type"}),(0,a.jsxs)(S.Ph,{value:u.type,onValueChange:e=>p("type",e),children:[(0,a.jsx)(S.i4,{children:(0,a.jsx)(S.ki,{placeholder:"Select progress type"})}),(0,a.jsxs)(S.Bw,{children:[(0,a.jsx)(S.Ql,{value:"hafalan",children:"Tahfidz"}),(0,a.jsx)(S.Ql,{value:"tilawah",children:"Tahsin"})]})]})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(w._,{htmlFor:"date",children:"Date"}),(0,a.jsx)(N.I,{id:"date",type:"date",value:u.date,onChange:e=>p("date",e.target.value),required:!0})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(w._,{htmlFor:"surah_or_jilid",children:"hafalan"===u.type?"Surah":"Jilid/Level"}),"hafalan"===u.type?(0,a.jsxs)(S.Ph,{value:u.surah_or_jilid,onValueChange:e=>p("surah_or_jilid",e),children:[(0,a.jsx)(S.i4,{children:(0,a.jsx)(S.ki,{placeholder:"Select a surah"})}),(0,a.jsx)(S.Bw,{children:T.n5.map(e=>(0,a.jsxs)(S.Ql,{value:e.name,children:[e.name," (",e.verses," verses)"]},e.number))})]}):(0,a.jsx)(N.I,{id:"surah_or_jilid",value:u.surah_or_jilid,onChange:e=>p("surah_or_jilid",e.target.value),placeholder:"e.g., Jilid 1"})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(w._,{htmlFor:"ayat_or_page",children:"hafalan"===u.type?"Ayat":"Page/Verse"}),(0,a.jsx)(N.I,{id:"ayat_or_page",value:u.ayat_or_page,onChange:e=>p("ayat_or_page",e.target.value),placeholder:"hafalan"===u.type?"e.g., 1-7":"e.g., Page 15"})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(w._,{htmlFor:"notes",children:"Notes (Optional)"}),(0,a.jsx)(_.g,{id:"notes",value:u.notes,onChange:e=>p("notes",e.target.value),placeholder:"Additional notes about the progress..."})]}),(0,a.jsxs)("div",{className:"flex justify-end space-x-2",children:[(0,a.jsx)(n.z,{type:"button",variant:"outline",onClick:()=>i(!1),children:"Cancel"}),(0,a.jsx)(b.O,{type:"submit",disabled:d,children:d?"Adding...":"Add Progress"})]})]})]})]})},O=s(39163),z=s(32581),A=s(49175),R=e=>{let{student:t,onStudentUpdated:s}=e,[l,i]=(0,r.useState)(!1),[d,o]=(0,r.useState)(!1),[c,u]=(0,r.useState)(null),[h,x]=(0,r.useState)({name:t.name,group_name:t.group_name,teacher:t.teacher}),{toast:m}=(0,E.pm)(),{profile:p}=(0,P.a)();if((null==p?void 0:p.role)!=="teacher")return null;let f=async e=>{try{let s=e.name.split(".").pop(),a="".concat(t.id,"-").concat(Math.random(),".").concat(s),r="student-photos/".concat(a),{error:l}=await D.O.storage.from("student-photos").upload(r,e);if(l)throw l;let{data:n}=D.O.storage.from("student-photos").getPublicUrl(r);return n.publicUrl}catch(e){return console.error("Error uploading image:",e),null}},g=async e=>{if(e.preventDefault(),(null==p?void 0:p.role)!=="teacher"){m({title:"Error",description:"You don't have permission to edit students.",variant:"destructive"});return}o(!0);try{let e=t.photo;if(c&&!(e=await f(c)))throw Error("Failed to upload image");let{error:a}=await D.O.from("students").update({...h,photo:e}).eq("id",t.id);if(a)throw a;m({title:"Success",description:"Student updated successfully!"}),i(!1),s()}catch(e){console.error("Error updating student:",e),m({title:"Error",description:"Failed to update student. Please try again.",variant:"destructive"})}finally{o(!1)}},j=(e,t)=>{x(s=>({...s,[e]:t}))};return(0,a.jsxs)(y.Vq,{open:l,onOpenChange:i,children:[(0,a.jsx)(y.hg,{asChild:!0,children:(0,a.jsxs)(n.z,{variant:"outline",size:"sm",id:"edit-student-trigger",children:[(0,a.jsx)(O.Z,{className:"h-4 w-4 mr-2"}),"Edit"]})}),(0,a.jsxs)(y.cZ,{className:"sm:max-w-[425px]","aria-describedby":"edit-student-description",children:[(0,a.jsxs)(y.fK,{children:[(0,a.jsx)(y.$N,{children:"Edit Student"}),(0,a.jsx)(y.Be,{id:"edit-student-description",children:"Update the student information below."})]}),(0,a.jsxs)("form",{onSubmit:g,className:"space-y-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(w._,{htmlFor:"photo",children:"Profile Photo"}),(0,a.jsx)(z.Z,{onFileSelect:u,currentImage:t.photo})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(w._,{htmlFor:"name",children:"Student Name"}),(0,a.jsx)(N.I,{id:"name",value:h.name,onChange:e=>j("name",e.target.value),required:!0})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(w._,{htmlFor:"group_name",children:"Group/Class"}),(0,a.jsx)(N.I,{id:"group_name",value:h.group_name,onChange:e=>j("group_name",e.target.value),required:!0})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(w._,{htmlFor:"teacher",children:"Teacher"}),(0,a.jsxs)(S.Ph,{value:h.teacher,onValueChange:e=>j("teacher",e),required:!0,children:[(0,a.jsx)(S.i4,{className:"w-full",children:(0,a.jsx)(S.ki,{placeholder:"Select teacher"})}),(0,a.jsx)(S.Bw,{children:A.LQ.map(e=>(0,a.jsx)(S.Ql,{value:e.name,children:e.name},e.id))})]})]}),(0,a.jsxs)("div",{className:"flex justify-end space-x-2",children:[(0,a.jsx)(n.z,{type:"button",variant:"outline",onClick:()=>i(!1),children:"Cancel"}),(0,a.jsx)(n.z,{type:"submit",disabled:d,children:d?"Updating...":"Update Student"})]})]})]})]})},F=s(11099),Z=e=>{let{studentId:t,studentName:s,onStudentDeleted:l}=e,[i,d]=(0,r.useState)(!1),{toast:o}=(0,E.pm)(),{profile:c}=(0,P.a)();if((null==c?void 0:c.role)!=="teacher")return null;let u=async()=>{if((null==c?void 0:c.role)!=="teacher"){o({title:"Error",description:"You don't have permission to delete students.",variant:"destructive"});return}d(!0);try{await D.O.from("progress_entries").delete().eq("student_id",t),await D.O.from("hafalan_progress").delete().eq("student_id",t),await D.O.from("tilawah_progress").delete().eq("student_id",t);let{error:e}=await D.O.from("students").delete().eq("id",t);if(e)throw e;o({title:"Success",description:"Student deleted successfully!"}),l()}catch(e){console.error("Error deleting student:",e),o({title:"Error",description:"Failed to delete student. Please try again.",variant:"destructive"})}finally{d(!1)}};return(0,a.jsxs)(F.aR,{children:[(0,a.jsx)(F.vW,{asChild:!0,children:(0,a.jsxs)(n.z,{variant:"destructive",size:"sm",id:"delete-student-trigger",children:[(0,a.jsx)(f.Z,{className:"h-4 w-4 mr-2"}),"Delete"]})}),(0,a.jsxs)(F._T,{children:[(0,a.jsxs)(F.fY,{children:[(0,a.jsx)(F.f$,{children:"Are you sure?"}),(0,a.jsxs)(F.yT,{children:["This will permanently delete ",(0,a.jsx)("strong",{children:s})," and all their progress data. This action cannot be undone."]})]}),(0,a.jsxs)(F.xo,{children:[(0,a.jsx)(F.le,{children:"Cancel"}),(0,a.jsx)(F.OL,{onClick:u,disabled:i,className:"bg-destructive text-destructive-foreground hover:bg-destructive/90",children:i?"Deleting...":"Delete"})]})]})]})},I=s(55051),L=s(14866),B=e=>{var t,s,r,l;let{student:i,progressData:d,onProgressAdded:c,onStudentUpdated:u,onStudentDeleted:y}=e,{profile:b}=(0,P.a)(),N=(null==b?void 0:b.role)==="teacher",w=(null==d?void 0:null===(t=d.hafalan_progress)||void 0===t?void 0:t.percentage)||0,_=(null==d?void 0:null===(s=d.hafalan_progress)||void 0===s?void 0:s.last_surah)||"Not started",S=(null==d?void 0:null===(r=d.tilawah_progress)||void 0===r?void 0:r.percentage)||0,C=(null==d?void 0:null===(l=d.tilawah_progress)||void 0===l?void 0:l.jilid)||"Not started",D=e=>e>=80?"bg-islamic-500":e>=60?"bg-blue-500":e>=40?"bg-accent-500":"bg-gray-500";return(0,a.jsx)(o.Zb,{className:"mb-8",children:(0,a.jsx)(o.aY,{className:"p-4 sm:p-6",children:(0,a.jsxs)("div",{className:"flex flex-col lg:flex-row lg:items-start lg:space-x-6",children:[(0,a.jsxs)("div",{className:"flex flex-col items-center justify-center mb-4 lg:mb-0 w-full lg:w-auto relative",children:[N&&(0,a.jsx)("div",{className:"absolute right-0 top-0 lg:hidden",children:(0,a.jsxs)(I.h_,{children:[(0,a.jsx)(I.$F,{asChild:!0,children:(0,a.jsx)(n.z,{variant:"ghost",size:"icon",className:"h-8 w-8",children:(0,a.jsx)(m.Z,{className:"h-4 w-4"})})}),(0,a.jsxs)(I.AW,{align:"end",children:[(0,a.jsxs)(I.Xi,{onSelect:()=>{var e;return null===(e=document.getElementById("edit-student-trigger"))||void 0===e?void 0:e.click()},children:[(0,a.jsx)(p.Z,{className:"mr-2 h-4 w-4"}),"Edit Profile"]}),(0,a.jsxs)(I.Xi,{className:"text-destructive focus:text-destructive",onSelect:()=>{var e;return null===(e=document.getElementById("delete-student-trigger"))||void 0===e?void 0:e.click()},children:[(0,a.jsx)(f.Z,{className:"mr-2 h-4 w-4"}),"Delete Profile"]})]})]})}),(0,a.jsxs)(x.qE,{className:"h-24 w-24 sm:h-28 sm:w-28 lg:h-32 lg:w-32",children:[(0,a.jsx)(x.F$,{src:i.photo||"",alt:i.name}),(0,a.jsx)(x.Q5,{className:"text-xl sm:text-2xl font-semibold bg-muted",children:i.name.split(" ").map(e=>e[0]).join("").toUpperCase()})]}),(0,a.jsxs)("div",{className:"block lg:hidden mt-4 w-full",children:[(0,a.jsx)("h2",{className:"text-2xl sm:text-3xl font-bold text-foreground text-center",children:i.name}),(0,a.jsxs)("div",{className:"flex flex-row flex-wrap gap-2 justify-center w-full mt-2",children:[(0,a.jsx)(L.C,{variant:"outline",className:"border-islamic-200 text-islamic-700",children:i.group_name}),(0,a.jsxs)(L.C,{variant:"secondary",className:"bg-accent/10 text-accent-foreground/80",children:[(0,a.jsx)(g.Z,{className:"h-3 w-3 mr-1"}),i.teacher]})]})]})]}),(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsx)("div",{className:"hidden lg:block text-left mb-6",children:(0,a.jsxs)("div",{className:"flex items-start justify-between mb-4",children:[(0,a.jsxs)("div",{className:"flex flex-col items-start gap-2",children:[(0,a.jsx)("h2",{className:"text-2xl sm:text-3xl font-bold text-foreground",children:i.name}),(0,a.jsxs)("div",{className:"flex flex-row flex-wrap gap-2 justify-start w-full",children:[(0,a.jsx)(L.C,{variant:"outline",className:"border-islamic-200 text-islamic-700",children:i.group_name}),(0,a.jsxs)(L.C,{variant:"secondary",className:"bg-accent/10 text-accent-foreground/80",children:[(0,a.jsx)(g.Z,{className:"h-3 w-3 mr-1"}),i.teacher]})]})]}),N&&(0,a.jsxs)(I.h_,{children:[(0,a.jsx)(I.$F,{asChild:!0,children:(0,a.jsx)(n.z,{variant:"ghost",size:"icon",className:"h-8 w-8",children:(0,a.jsx)(m.Z,{className:"h-4 w-4"})})}),(0,a.jsxs)(I.AW,{align:"end",children:[(0,a.jsxs)(I.Xi,{onSelect:()=>{var e;return null===(e=document.getElementById("edit-student-trigger"))||void 0===e?void 0:e.click()},children:[(0,a.jsx)(p.Z,{className:"mr-2 h-4 w-4"}),"Edit Profile"]}),(0,a.jsxs)(I.Xi,{className:"text-destructive focus:text-destructive",onSelect:()=>{var e;return null===(e=document.getElementById("delete-student-trigger"))||void 0===e?void 0:e.click()},children:[(0,a.jsx)(f.Z,{className:"mr-2 h-4 w-4"}),"Delete Profile"]})]})]})]})}),(0,a.jsxs)("div",{className:"hidden",children:[(0,a.jsx)(R,{student:i,onStudentUpdated:u}),(0,a.jsx)(Z,{studentId:i.id,studentName:i.name,onStudentDeleted:y})]}),(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold text-foreground",children:"Progress Overview"}),N&&(0,a.jsx)(k,{studentId:i.id,onProgressAdded:c})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4 sm:gap-6",children:[(0,a.jsx)("div",{className:"bg-gradient-to-r from-green-100 via-green-50 to-green-200 rounded-xl shadow-sm hover:shadow-md transition-shadow w-full h-full",children:(0,a.jsxs)("div",{className:"p-4",children:[(0,a.jsxs)("div",{className:"flex items-center mb-3",children:[(0,a.jsx)(j.Z,{className:"h-6 w-6 text-green-600 mr-2"}),(0,a.jsx)("h3",{className:"font-semibold text-green-900",children:"Tahfidz Progress"})]}),(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsx)(h,{value:w,className:"h-2.5",indicatorClassName:D(w)}),(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsxs)("p",{className:"text-sm font-medium text-foreground",children:[w,"% completed"]}),(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:_})]})]})]})}),(0,a.jsx)("div",{className:"bg-gradient-to-r from-blue-100 via-blue-50 to-blue-200 rounded-xl shadow-sm hover:shadow-md transition-shadow w-full h-full",children:(0,a.jsxs)("div",{className:"p-4",children:[(0,a.jsxs)("div",{className:"flex items-center mb-3",children:[(0,a.jsx)(v.Z,{className:"h-6 w-6 text-blue-600 mr-2"}),(0,a.jsx)("h3",{className:"font-semibold text-blue-900",children:"Tahsin Progress"})]}),(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsx)(h,{value:S,className:"h-2.5",indicatorClassName:D(S)}),(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsxs)("p",{className:"text-sm font-medium text-foreground",children:[S,"% completed"]}),(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:C})]})]})]})})]})]})]})]})})})},U=s(60434);let V=U.fC,q=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)(U.aV,{ref:t,className:(0,u.cn)("inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground",s),...r})});q.displayName=U.aV.displayName;let M=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)(U.xz,{ref:t,className:(0,u.cn)("inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm",s),...r})});M.displayName=U.xz.displayName;let Y=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)(U.VY,{ref:t,className:(0,u.cn)("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",s),...r})});Y.displayName=U.VY.displayName;var $=s(70207),Q=e=>{let{entry:t,onProgressUpdated:s}=e,[l,i]=(0,r.useState)(!1),[d,o]=(0,r.useState)(!1),[c,u]=(0,r.useState)({date:t.date,surah_or_jilid:t.surah_or_jilid||"",ayat_or_page:t.ayat_or_page||"",notes:t.notes||""}),{toast:h}=(0,E.pm)(),x=async e=>{e.preventDefault(),o(!0);try{let{error:e}=await D.O.from("progress_entries").update(c).eq("id",t.id);if(e)throw e;h({title:"Success",description:"Progress updated successfully!"}),i(!1),s()}catch(e){console.error("Error updating progress:",e),h({title:"Error",description:"Failed to update progress. Please try again.",variant:"destructive"})}finally{o(!1)}},m=(e,t)=>{u(s=>({...s,[e]:t}))};return(0,a.jsxs)(y.Vq,{open:l,onOpenChange:i,children:[(0,a.jsx)(y.hg,{asChild:!0,children:(0,a.jsx)(n.z,{variant:"ghost",size:"sm",children:(0,a.jsx)(O.Z,{className:"h-4 w-4"})})}),(0,a.jsxs)(y.cZ,{className:"sm:max-w-[425px]","aria-describedby":"edit-progress-description",children:[(0,a.jsxs)(y.fK,{children:[(0,a.jsxs)(y.$N,{children:["Edit ","hafalan"===t.type?"Hafalan":"Tilawati"," Progress"]}),(0,a.jsx)(y.Be,{id:"edit-progress-description",children:"Update the progress details for this entry."})]}),(0,a.jsxs)("form",{onSubmit:x,className:"space-y-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(w._,{htmlFor:"date",children:"Date"}),(0,a.jsx)(N.I,{id:"date",type:"date",value:c.date,onChange:e=>m("date",e.target.value),required:!0})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(w._,{htmlFor:"surah_or_jilid",children:"hafalan"===t.type?"Surah":"Jilid/Level"}),"hafalan"===t.type?(0,a.jsxs)(S.Ph,{value:c.surah_or_jilid,onValueChange:e=>m("surah_or_jilid",e),children:[(0,a.jsx)(S.i4,{children:(0,a.jsx)(S.ki,{placeholder:"Select a surah"})}),(0,a.jsx)(S.Bw,{children:T.n5.map(e=>(0,a.jsxs)(S.Ql,{value:e.name,children:[e.name," (",e.verses," verses)"]},e.number))})]}):(0,a.jsx)(N.I,{id:"surah_or_jilid",value:c.surah_or_jilid,onChange:e=>m("surah_or_jilid",e.target.value),placeholder:"e.g., Jilid 1"})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(w._,{htmlFor:"ayat_or_page",children:"hafalan"===t.type?"Ayat":"Page"}),(0,a.jsx)(N.I,{id:"ayat_or_page",value:c.ayat_or_page,onChange:e=>m("ayat_or_page",e.target.value),placeholder:"hafalan"===t.type?"e.g., 1-7":"e.g., 5"})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(w._,{htmlFor:"notes",children:"Notes"}),(0,a.jsx)(_.g,{id:"notes",value:c.notes,onChange:e=>m("notes",e.target.value),placeholder:"Additional notes...",rows:3})]}),(0,a.jsxs)("div",{className:"flex justify-end space-x-2",children:[(0,a.jsx)(n.z,{type:"button",variant:"outline",onClick:()=>i(!1),children:"Cancel"}),(0,a.jsx)(n.z,{type:"submit",disabled:d,children:d?"Updating...":"Update Progress"})]})]})]})]})},J=e=>{let{entryId:t,entryType:s,onProgressDeleted:l}=e,[i,d]=(0,r.useState)(!1),{toast:o}=(0,E.pm)(),c=async()=>{d(!0);try{let{error:e}=await D.O.from("progress_entries").delete().eq("id",t);if(e)throw e;o({title:"Success",description:"Progress entry deleted successfully!"}),l()}catch(e){console.error("Error deleting progress:",e),o({title:"Error",description:"Failed to delete progress entry. Please try again.",variant:"destructive"})}finally{d(!1)}};return(0,a.jsxs)(F.aR,{children:[(0,a.jsx)(F.vW,{asChild:!0,children:(0,a.jsx)(n.z,{variant:"ghost",size:"sm",children:(0,a.jsx)(f.Z,{className:"h-4 w-4"})})}),(0,a.jsxs)(F._T,{children:[(0,a.jsxs)(F.fY,{children:[(0,a.jsx)(F.f$,{children:"Delete Progress Entry"}),(0,a.jsxs)(F.yT,{children:["Are you sure you want to delete this ",s," progress entry? This action cannot be undone."]})]}),(0,a.jsxs)(F.xo,{children:[(0,a.jsx)(F.le,{children:"Cancel"}),(0,a.jsx)(F.OL,{onClick:c,disabled:i,className:"bg-destructive text-destructive-foreground hover:bg-destructive/90",children:i?"Deleting...":"Delete"})]})]})]})},X=s(32604),G=s(47782),W=e=>{let{entries:t,type:s,onProgressUpdated:l,onDuplicateEntry:d}=e,{profile:o}=(0,P.a)(),c=(null==o?void 0:o.role)==="teacher",u="hafalan"===s,[h,x]=(0,r.useState)(10),[m,p]=(0,r.useState)(1),f=Math.ceil(t.length/h),g=t.slice((m-1)*h,m*h);return r.useEffect(()=>{p(1)},[t.length,h]),(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)($.iA,{children:[(0,a.jsx)($.xD,{children:(0,a.jsxs)($.SC,{children:[(0,a.jsx)($.ss,{children:"Date"}),(0,a.jsx)($.ss,{children:u?"Surah":"Jilid/Level"}),(0,a.jsx)($.ss,{children:u?"Ayat":"Page/Verse"}),(0,a.jsx)($.ss,{children:"Notes"}),c&&(0,a.jsx)($.ss,{children:"Actions"})]})}),(0,a.jsx)($.RM,{children:0===t.length?(0,a.jsx)($.SC,{children:(0,a.jsxs)($.pj,{colSpan:c?5:4,className:"text-center text-gray-500",children:["No ",s," progress recorded yet"]})}):g.map(e=>(0,a.jsxs)($.SC,{children:[(0,a.jsx)($.pj,{children:new Date(e.date).toLocaleDateString()}),(0,a.jsx)($.pj,{children:e.surah_or_jilid||"-"}),(0,a.jsx)($.pj,{children:e.ayat_or_page||"-"}),(0,a.jsx)($.pj,{children:e.notes||"-"}),c&&(0,a.jsx)($.pj,{children:(0,a.jsxs)("div",{className:"flex space-x-1",children:[(0,a.jsx)(Q,{entry:e,onProgressUpdated:l}),(0,a.jsx)("button",{type:"button",className:"inline-flex items-center justify-center rounded p-2 text-black transition-transform duration-150 hover:scale-110 hover:text-blue-600 focus:outline-none",title:"Duplicate",onClick:()=>d&&d(e),children:(0,a.jsx)(X.Z,{className:"h-4 w-4"})}),(0,a.jsx)(J,{entryId:e.id,entryType:s,onProgressDeleted:l})]})})]},e.id))})]}),f>1||t.length>0?(0,a.jsxs)("div",{className:"px-4 py-3 border-t border-gray-200 bg-white gap-2 flex flex-col sm:flex-row sm:items-center sm:relative",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 mb-2 sm:mb-0",children:[(0,a.jsx)("span",{className:"text-xs text-gray-600",children:"Rows per page:"}),(0,a.jsxs)(S.Ph,{value:String(h),onValueChange:e=>x(Number(e)),children:[(0,a.jsx)(S.i4,{className:"w-16 h-8 text-xs",children:(0,a.jsx)(S.ki,{})}),(0,a.jsxs)(S.Bw,{children:[(0,a.jsx)(S.Ql,{value:"5",children:"5"}),(0,a.jsx)(S.Ql,{value:"10",children:"10"})]})]})]}),(0,a.jsxs)("div",{className:"flex items-center gap-1 w-full sm:w-auto sm:ml-auto",children:[(0,a.jsxs)("span",{className:"text-xs text-gray-600 font-medium sm:absolute sm:left-1/2 sm:-translate-x-1/2 sm:w-auto",children:["Page ",m," of ",f]}),(0,a.jsxs)(n.z,{variant:"outline",size:"sm",onClick:()=>p(m-1),disabled:1===m,"aria-label":"Previous Page",className:"ml-2 sm:ml-4",children:[(0,a.jsx)(i.Z,{className:"h-4 w-4"}),(0,a.jsx)("span",{className:"sr-only",children:"Previous"})]}),(0,a.jsxs)(n.z,{variant:"outline",size:"sm",onClick:()=>p(m+1),disabled:m===f,"aria-label":"Next Page",children:[(0,a.jsx)(G.Z,{className:"h-4 w-4"}),(0,a.jsx)("span",{className:"sr-only",children:"Next"})]})]})]}):null]})},H=s(84105),K=s(91819);let ee=e=>{let t=new Date(e);if(isNaN(t.getTime())){let t=e.split("-");if(3===t.length)return new Date(parseInt(t[0]),parseInt(t[1])-1,parseInt(t[2]));throw Error("Invalid date format: ".concat(e))}return t},et=e=>{let t=new Date(e);return t.setHours(0,0,0,0),t},es=e=>{let t=new Date(e);return t.setHours(23,59,59,999),t};var ea=e=>{let{open:t,onOpenChange:s,hafalanEntries:l,tilawahEntries:i}=e,[d]=(0,r.useState)([...l,...i]),o=d.map(e=>({...e,parsedDate:ee(e.date)})).sort((e,t)=>e.parsedDate.getTime()-t.parsedDate.getTime()),[c,u]=(0,r.useState)(!1),[h,x]=(0,r.useState)("today"),[m,p]=(0,r.useState)(null);r.useEffect(()=>{},[h,o.length]);let f=new Date,g=et(f),j=es(f),v=et(new Date(f.getFullYear(),f.getMonth(),f.getDate()-6)),b=et(new Date(f.getFullYear(),f.getMonth(),1)),N=es(new Date(f.getFullYear(),f.getMonth()+1,0)),w=o,_="";"today"===h?(w=o.filter(e=>e.parsedDate>=g&&e.parsedDate<=j),_="Today (".concat(g.toLocaleDateString(),")")):"7days"===h?(w=o.filter(e=>e.parsedDate>=v&&e.parsedDate<=j),_="Last 7 Days (".concat(v.toLocaleDateString()," - ").concat(j.toLocaleDateString(),")")):"month"===h&&(w=o.filter(e=>e.parsedDate>=b&&e.parsedDate<=N),_="This Month (".concat(b.toLocaleDateString()," - ").concat(N.toLocaleDateString(),")"));let C=()=>{if(0!==w.length){u(!0);try{let e=w.map(e=>({Date:e.parsedDate.toLocaleDateString("en-CA"),Type:e.type,"Surah/Jilid":e.surah_or_jilid||"-","Ayat/Page":e.ayat_or_page||"-",Notes:e.notes||"-"})),t=H.P6.json_to_sheet(e),a=H.P6.decode_range(t["!ref"]||"A1"),r=[];for(let e=a.s.c;e<=a.e.c;++e){let s=10;for(let r=a.s.r;r<=a.e.r;++r){let a=t[H.P6.encode_cell({r:r,c:e})];if(a&&a.v){let e=a.v.toString().length;e>s&&(s=e)}}r.push({wch:Math.min(s+2,50)})}t["!cols"]=r;let l=H.P6.book_new();H.P6.book_append_sheet(l,t,"Progress Entries");let n="progress_entries_".concat(h,"_").concat(new Date().toLocaleDateString("en-CA"),".xlsx");H.NC(l,n),s(!1)}catch(e){console.error("Error exporting Excel:",e)}finally{u(!1)}}},D=()=>{if(0!==w.length){u(!0);try{let e=new K.ZP;e.setFontSize(16),e.text("Progress Entries Report",20,20),e.setFontSize(10),e.text(_,20,30),e.text("Total Entries: ".concat(w.length),20,35);let t=45;e.setFontSize(8),e.text("Date",20,t),e.text("Type",50,t),e.text("Surah/Jilid",80,t),e.text("Ayat/Page",120,t),e.text("Notes",150,t),e.line(20,t+2,190,t+2),t+=8,w.forEach(s=>{t>280&&(e.addPage(),t=20,e.setFontSize(8),e.text("Date",20,t),e.text("Type",50,t),e.text("Surah/Jilid",80,t),e.text("Ayat/Page",120,t),e.text("Notes",150,t),e.line(20,t+2,190,t+2),t+=8),e.setFontSize(8),e.text(s.parsedDate.toLocaleDateString(),20,t),e.text(s.type,50,t),e.text(s.surah_or_jilid||"-",80,t),e.text(s.ayat_or_page||"-",120,t);let a=s.notes||"-",r=a.length>25?a.substring(0,25)+"...":a;e.text(r,150,t),t+=6});let a="progress_entries_".concat(h,"_").concat(new Date().toLocaleDateString("en-CA"),".pdf");e.save(a),s(!1)}catch(e){console.error("Error exporting PDF:",e)}finally{u(!1)}}},E=()=>{"excel"===m&&C(),"pdf"===m&&D(),p(null)};return(0,a.jsx)(y.Vq,{open:t,onOpenChange:s,children:(0,a.jsxs)(y.cZ,{className:"max-w-md w-full p-6",children:[(0,a.jsxs)(y.fK,{children:[(0,a.jsx)(y.$N,{children:"Export Progress Entries"}),(0,a.jsx)(y.Be,{children:"Choose a range and export the student's progress as Excel or PDF."})]}),(0,a.jsxs)("div",{className:"mb-4 bg-gray-50 rounded p-3",children:[(0,a.jsx)("label",{className:"block mb-2 font-medium",children:"Select Range"}),(0,a.jsxs)(S.Ph,{value:h,onValueChange:e=>x(e),children:[(0,a.jsx)(S.i4,{className:"w-full",children:(0,a.jsx)(S.ki,{placeholder:"Select range"})}),(0,a.jsxs)(S.Bw,{children:[(0,a.jsx)(S.Ql,{value:"today",children:"This Day"}),(0,a.jsx)(S.Ql,{value:"7days",children:"Last 7 Days"}),(0,a.jsx)(S.Ql,{value:"month",children:"This Month"})]})]}),(0,a.jsx)("p",{className:"text-xs text-gray-600 mt-2 mb-1",children:_.replace(/'/g,"&apos;")}),(0,a.jsxs)("div",{className:"text-xs text-gray-600",children:[w.length," entries will be exported."]}),w.length>0&&(0,a.jsx)("div",{className:"mt-4 border rounded bg-white overflow-x-auto",children:(0,a.jsxs)("table",{className:"w-full text-xs",children:[(0,a.jsx)("thead",{className:"bg-gray-50",children:(0,a.jsxs)("tr",{children:[(0,a.jsx)("th",{className:"px-2 py-2 text-left font-semibold text-gray-600",children:"Date"}),(0,a.jsx)("th",{className:"px-2 py-2 text-left font-semibold text-gray-600",children:"Type"}),(0,a.jsx)("th",{className:"px-2 py-2 text-left font-semibold text-gray-600",children:"Surah/Jilid"}),(0,a.jsx)("th",{className:"px-2 py-2 text-left font-semibold text-gray-600",children:"Ayat/Page"}),(0,a.jsx)("th",{className:"px-2 py-2 text-left font-semibold text-gray-600",children:"Notes"})]})}),(0,a.jsx)("tbody",{children:w.map(e=>(0,a.jsxs)("tr",{className:"border-b last:border-0",children:[(0,a.jsx)("td",{className:"px-2 py-1",children:e.parsedDate.toLocaleDateString()}),(0,a.jsx)("td",{className:"px-2 py-1",children:e.type}),(0,a.jsx)("td",{className:"px-2 py-1",children:e.surah_or_jilid||"-"}),(0,a.jsx)("td",{className:"px-2 py-1",children:e.ayat_or_page||"-"}),(0,a.jsx)("td",{className:"px-2 py-1",children:e.notes?e.notes.length>20?e.notes.slice(0,20)+"...":e.notes:"-"})]},e.id))})]})})]}),(0,a.jsxs)("div",{className:"flex flex-col sm:flex-row gap-2 justify-end",children:[(0,a.jsxs)(F.aR,{children:[(0,a.jsx)(F.vW,{asChild:!0,children:(0,a.jsx)(n.z,{onClick:()=>p("excel"),disabled:c||0===w.length,variant:"outline",className:"flex-1 transition-transform duration-200 hover:scale-105 border-2 border-gray-400 text-gray-700 hover:border-green-400 hover:bg-gradient-to-r hover:from-green-400 hover:to-teal-500 hover:text-white",children:"Export as Excel"})}),(0,a.jsxs)(F._T,{children:[(0,a.jsxs)(F.fY,{children:[(0,a.jsx)(F.f$,{children:"Confirm Export"}),(0,a.jsx)(F.yT,{children:"Are you sure you want to export progress for ".concat(_,"?")})]}),(0,a.jsxs)(F.xo,{children:[(0,a.jsx)(F.le,{onClick:()=>p(null),children:"Cancel"}),(0,a.jsx)(F.OL,{onClick:E,children:"Export"})]})]})]}),(0,a.jsxs)(F.aR,{children:[(0,a.jsx)(F.vW,{asChild:!0,children:(0,a.jsx)(n.z,{onClick:()=>p("pdf"),disabled:c||0===w.length,variant:"outline",className:"flex-1 transition-transform duration-200 hover:scale-105 border-2 border-gray-400 text-gray-700 hover:border-green-400 hover:bg-gradient-to-r hover:from-green-400 hover:to-teal-500 hover:text-white",children:"Export as PDF"})}),(0,a.jsxs)(F._T,{children:[(0,a.jsxs)(F.fY,{children:[(0,a.jsx)(F.f$,{children:"Confirm Export"}),(0,a.jsx)(F.yT,{children:"Are you sure you want to export progress for ".concat(_,"?")})]}),(0,a.jsxs)(F.xo,{children:[(0,a.jsx)(F.le,{onClick:()=>p(null),children:"Cancel"}),(0,a.jsx)(F.OL,{onClick:E,children:"Export"})]})]})]}),(0,a.jsx)(y.GG,{asChild:!0,children:(0,a.jsx)(n.z,{variant:"ghost",className:"flex-1",children:"Cancel"})})]}),0===w.length&&(0,a.jsx)("div",{className:"text-center text-sm text-red-500 mt-2",children:"No entries found in the selected range."}),0===d.length&&(0,a.jsx)("div",{className:"text-center text-sm text-gray-500 mt-2",children:"No entries available to export."})]})})},er=e=>{let{hafalanEntries:t,tilawahEntries:s,onProgressUpdated:l,studentId:i}=e,[d,c]=r.useState(!1),u=async(e,t)=>{if(!i)return;let s={student_id:i,date:new Date().toISOString().split("T")[0],type:t.type,surah_or_jilid:t.surah_or_jilid,ayat_or_page:t.ayat_or_page,notes:t.notes},{error:a}=await D.O.from("progress_entries").insert([s]);a||l()};return(0,a.jsxs)(o.Zb,{children:[(0,a.jsxs)(o.Ol,{className:"flex flex-row items-center justify-between",children:[(0,a.jsx)(o.ll,{children:"Daily Progress Records"}),(0,a.jsx)(n.z,{variant:"outline",onClick:()=>c(!0),children:"Export"}),(0,a.jsx)(ea,{open:d,onOpenChange:c,hafalanEntries:t,tilawahEntries:s})]}),(0,a.jsx)(o.aY,{children:(0,a.jsxs)(V,{defaultValue:"hafalan",className:"w-full",children:[(0,a.jsxs)(q,{className:"grid w-full grid-cols-2",children:[(0,a.jsx)(M,{value:"hafalan",className:"data-[state=active]:bg-green-100 data-[state=active]:text-green-700",children:"Tahfidz"}),(0,a.jsx)(M,{value:"tilawah",className:"data-[state=active]:bg-blue-100 data-[state=active]:text-blue-700",children:"Tahsin"})]}),(0,a.jsx)(Y,{value:"hafalan",className:"mt-6",children:(0,a.jsx)(W,{entries:t,type:"hafalan",onProgressUpdated:l,onDuplicateEntry:e=>u("hafalan",e)})}),(0,a.jsx)(Y,{value:"tilawah",className:"mt-6",children:(0,a.jsx)(W,{entries:s,type:"tilawah",onProgressUpdated:l,onDuplicateEntry:e=>u("tilawah",e)})})]})})]})},el=s(43463);let en=e=>{let{profile:t}=(0,P.a)(),[s,a]=(0,r.useState)(null),[l,n]=(0,r.useState)({hafalan_progress:null,tilawah_progress:null}),[i,d]=(0,r.useState)([]),[o,c]=(0,r.useState)([]),[u,h]=(0,r.useState)(!0),x=async()=>{try{if(!e||!t){a(null);return}let{data:s,error:r}=await D.O.from("students").select("*").eq("id",e).maybeSingle();if(r)throw r;if(!s){a(null);return}a(s)}catch(e){console.error("Error fetching student data:",e),a(null)}finally{h(!1)}},m=async()=>{try{if(!s||!e)return;let{data:a,error:r}=await D.O.from("progress_entries").select("*").eq("student_id",e).order("date",{ascending:!1});if(r)throw r;let l=(null==a?void 0:a.filter(e=>"hafalan"===e.type))||[],i=(null==a?void 0:a.filter(e=>"tilawah"===e.type))||[];d(l),c(i);let o=(0,el.B)(l),u=(0,el.L)(i);n({hafalan_progress:o.percentage>0?o:null,tilawah_progress:u.percentage>0?u:null}),(null==t?void 0:t.role)==="teacher"&&(l.length>0&&e&&await D.O.from("hafalan_progress").upsert({student_id:e,percentage:o.percentage,last_surah:o.last_surah,updated_at:new Date().toISOString()}),i.length>0&&e&&await D.O.from("tilawah_progress").upsert({student_id:e,percentage:u.percentage,jilid:u.jilid,updated_at:new Date().toISOString()}))}catch(e){console.error("Error fetching progress entries:",e)}};return(0,r.useEffect)(()=>{e&&x()},[e,t]),(0,r.useEffect)(()=>{s&&m()},[s]),{student:s,progressData:l,hafalanEntries:i,tilawahEntries:o,loading:u,refetchData:()=>{x(),m()}}};var ei=s(58474),ed=s(98408),eo=()=>{let e=(0,l.useParams)(),t=null==e?void 0:e.id,s=(0,l.useRouter)(),{profile:r}=(0,P.a)(),{student:i,progressData:o,hafalanEntries:c,tilawahEntries:u,loading:h,refetchData:x}=en(t);if(h)return(0,a.jsx)("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:(0,a.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-islamic-500"})});if(!i)return(0,a.jsx)("div",{className:"min-h-screen bg-gray-50",children:(0,a.jsx)("div",{className:"container mx-auto px-6 py-8",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("h1",{className:"text-2xl font-bold text-gray-900 mb-4",children:"Student Not Found"}),(0,a.jsx)(n.z,{onClick:()=>s.back(),children:"Back"})]})})});let m=[{label:"Dashboard",href:"/dashboard"},{label:i.group_name,href:"/class/".concat(encodeURIComponent(i.group_name))},{label:i.name}],p=(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(d,{student:{...i,grade:i.grade||"Unknown"},userRole:(null==r?void 0:r.role)||"parent",profile:r||void 0}),(0,a.jsx)(B,{student:i,progressData:o,onProgressAdded:x,onStudentUpdated:x,onStudentDeleted:()=>{s.push("/dashboard")}}),(0,a.jsx)(er,{hafalanEntries:c,tilawahEntries:u,onProgressUpdated:x,studentId:i.id})]});return(null==r?void 0:r.role)==="parent"?(0,a.jsx)(ed.Z,{breadcrumbs:m,children:p}):(0,a.jsx)(ei.Z,{breadcrumbs:m,children:p})}},20067:function(){},72061:function(){}},function(e){e.O(0,[2251,7847,9332,1799,8288,1664,1063,7197,1134,5594,318,7800,7529,2888,9774,179],function(){return e(e.s=66023)}),_N_E=e.O()}]);